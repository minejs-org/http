var y=null;function p(c){let t=c,e=new Set;function r(){return y&&e.add(y),t}function s(i){Object.is(t,i)||(t=i,e.forEach(l=>l()));}function u(i){s(i(t));}function a(){return t}function n(i){return e.add(i),()=>e.delete(i)}let o=r;return o.set=s,o.update=u,o.peek=a,o.subscribe=n,o}function h(c){let t,e=false,r=()=>{if(e)return;t&&(t(),t=void 0);let u=y;y=r;try{let a=c();typeof a=="function"&&(t=a);}finally{y=u;}};r();let s=()=>{e||(e=true,t&&t());};return s}function m(c){let t=p(void 0);h(()=>{t.set(c());});let e=t;return Object.defineProperty(e,"isComputed",{value:true,writable:false}),e}var d=class{constructor(t={}){this.config={};this.requestInterceptors=[];this.responseInterceptors=[];this.cache=new Map;this.config=t;}setConfig(t){this.config={...this.config,...t};}interceptRequest(t){return this.requestInterceptors.push(t),()=>{let e=this.requestInterceptors.indexOf(t);e>-1&&this.requestInterceptors.splice(e,1);}}interceptResponse(t){return this.responseInterceptors.push(t),()=>{let e=this.responseInterceptors.indexOf(t);e>-1&&this.responseInterceptors.splice(e,1);}}async request(t){let e={...this.config,...t};for(let r of this.requestInterceptors)r.onFulfilled&&(e=await r.onFulfilled(e));try{let r=this.getCacheKey(e),s=this.cache.get(r);if(s&&Date.now()-s.timestamp<(e.timeout||0))return s.data;let u=this.buildURL(e),a=new Request(u,{method:e.method||"GET",headers:new Headers(e.headers||{}),body:e.data?JSON.stringify(e.data):void 0,signal:e.signal,credentials:e.withCredentials?"include":"same-origin"}),n=await fetch(a),o;switch(e.responseType||"json"){case "json":o=await n.json();break;case "text":o=await n.text();break;case "blob":o=await n.blob();break;case "arraybuffer":o=await n.arrayBuffer();break;default:o=await n.json();}let l={data:o,status:n.status,statusText:n.statusText,headers:n.headers,config:e};if(!n.ok)throw this.createError(`Request failed with status ${n.status}`,e,l);for(let f of this.responseInterceptors)f.onFulfilled&&(l=await f.onFulfilled(l));return this.cache.set(r,{data:l,timestamp:Date.now()}),l}catch(r){let s=r;for(let u of this.responseInterceptors)u.onRejected&&(s=await u.onRejected(s));throw s}}buildURL(t){let e=t.url;if(t.baseURL&&(e=t.baseURL+e),t.params){let r=new URLSearchParams;Object.entries(t.params).forEach(([u,a])=>{a!=null&&r.append(u,String(a));});let s=r.toString();s&&(e+=(e.includes("?")?"&":"?")+s);}return e}getCacheKey(t){return `${t.method||"GET"}:${t.url}:${JSON.stringify(t.params||{})}`}createError(t,e,r){let s=new Error(t);return s.config=e,s.response=r,s.status=r?.status,s}get(t,e){return this.request({...e,url:t,method:"GET"})}post(t,e,r){return this.request({...r,url:t,data:e,method:"POST"})}put(t,e,r){return this.request({...r,url:t,data:e,method:"PUT"})}patch(t,e,r){return this.request({...r,url:t,data:e,method:"PATCH"})}delete(t,e){return this.request({...e,url:t,method:"DELETE"})}},T=new d;function w(c){T.setConfig(c);}function C(c,t,e={}){let r=p(null),s=p(null),u=p(false),a=m(()=>s()!==null),n=m(()=>r()!==null&&s()===null),o=typeof e.enabled=="function"?e.enabled:p(e.enabled!==false),i=async()=>{if(o()){u.set(true),s.set(null);try{let l=await t();r.set(l.data),e.onSuccess?.(l.data);}catch(l){let f=l;s.set(f),e.onError?.(f);}finally{u.set(false);}}};return h(()=>{o()&&i();}),e.refetchOnWindowFocus&&window.addEventListener("focus",i),e.refetchInterval&&setInterval(i,e.refetchInterval),{data:r,error:s,isLoading:u,isError:a,isSuccess:n,refetch:i}}function q(c,t={}){let e=p(null),r=p(null),s=p(false);return {data:e,error:r,isLoading:s,mutate:async n=>{s.set(true),r.set(null),t.onMutate?.(n);try{let o=await c(n);return e.set(o.data),t.onSuccess?.(o.data,n),o.data}catch(o){let i=o;throw r.set(i),t.onError?.(i,n),i}finally{s.set(false);}},reset:()=>{e.set(null),r.set(null),s.set(false);}}}async function E(c,t={}){let{retries:e=3,retryDelay:r=a=>Math.min(1e3*2**a,3e4),retryCondition:s=()=>true}=t,u;for(let a=0;a<=e;a++)try{return await c()}catch(n){if(u=n,a<e&&s(n)){let o=typeof r=="function"?r(a):r;await new Promise(i=>setTimeout(i,o));}else throw n}throw u}function P(c){let t=new AbortController;return c&&setTimeout(()=>t.abort(),c),t}var I={HttpClient:d,http:T,configureHttp:w,useQuery:C,useMutation:q,retry:E,createAbortController:P};export{d as HttpClient,w as configureHttp,P as createAbortController,I as default,T as http,E as retry,q as useMutation,C as useQuery};//# sourceMappingURL=main.js.map
//# sourceMappingURL=main.js.map